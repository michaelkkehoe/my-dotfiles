#!/bin/zsh

# zshrc

[ -n "$PS1" ] && source ~/.zsh_profile

# 1. Identify the current shell (e.g., 'zsh' or 'bash')
CURRENT_SHELL_NAME="${SHELL##*/}"

# 2. Count how many instances of this shell are running.
#    Works on both macOS and Linux using standard 'ps'.
SHELL_COUNT=$(ps -A -o comm= | grep -c "$CURRENT_SHELL_NAME")

# 3. Only run if SHELL_COUNT is 1 (meaning this is the first/only window)
if [ "$SHELL_COUNT" -eq 1 ]; then
    if [[ "$(uname)" == "Darwin" ]]; then
        # macOS: Use --apple-time
        ping  --apple-time 1.1.1.1
    elif [[ "$(uname)" == "Linux" ]]; then
        # Linux: Standard ping (must use -c 1 to prevent hanging)
        ping 1.1.1.1
    fi
fi
# --- Network Check End ---